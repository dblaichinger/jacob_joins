{
  "ingredients": <%= @ingredients.inspect.html_safe %>,
  "recipes": [
    <% @recipes.each_with_index do |r, index| %>
      {
        "slug": "<%= r.slug %>",
        "name": "<%= r.name %>",
        "country": "<%= r.country %>",
        "duration": "<%= r.duration.to_i %>",
        "user": {
          "firstname": "<%= r.user.firstname.capitalize %>",
          "lastname": "<%= r.user.shorten_lastname %>"
        }
      }<%= "," if index != @recipes.count - 1 %>
    <% end %>
  ],
  "markers": [
    <% @recipes.each_with_index do |r, index| %>
      {
        "lat": "<%= r.latitude %>",
        "lng": "<%= r.longitude %>",
        "title": "<%= r.name %>",
        "description": "<div class='recipe_marker_result'><p class='infobox_recipe'><a href='/recipes/<%=r.slug%>' class='recipe_link'><%=r.name%></a></p><p class='infobox_author'> cooked by <em><%=r.user.firstname%> <%=r.user.shorten_lastname%></em>, <%=r.city%> </p><p class='infobox_duration'> Estimated cooking time: <%=r.duration%> minutes</p></div>"
      }<%= "," if index != @recipes.count - 1 %>
    <% end %>
  ]
}

