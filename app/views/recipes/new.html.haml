//- content_for(:head) do
:javascript
  $(document).ready(function(){
    getGeoLocation();

    //TODO: VorschlÃ¤ge von Google API anzeigen, sonst reicht .change auch
    $('#recipe_city').bind('keypress', function(){
      var self = $(this);
      clearTimeout(self.data('timeout'));
      self.data('timeout', setTimeout(function(){
        var city = $('#recipe_city').val();
        var country = $('#recipe_country').val();
        getLatLngFromAddress(city, country);
      }, 500));
    });

    $("#dynamicContainer").elementOnDemand();
  });
  
%h1 New_recipe

= form_for @recipe, :url => { :action => "create" } do |f|
  %p
    = f.label :name, "Name"
    = f.text_field :name
  %p
    = f.label :portion, "Anzahl Portionen"
    = f.text_field :portion

  %div#dynamicContainer
    %p.dynamicElement
      = text_field_tag "recipe[ingredients_strings][][quantity]", nil, :id => "recipe_ingredients_strings_quantity"
      = text_field_tag "recipe[ingredients_strings][][ingredient]", nil, :id => "recipe_ingredients_strings_ingredient"

  %p
    = f.label :preparation, "Zubereitung"
    = f.text_area :preparation
  %p
    = f.label :duration, "Zubereitungszeit in Minuten"
    = f.text_field :duration
  %p
    = f.label :country, "Land"
    - if @location.data['country_name'].empty?
      = f.text_field :country
    - else
      = f.text_field :country, :value => @location.data['country_name']
      
  %p
    = f.label :city, "Stadt"
    - if @location.data['city'].empty?
      = f.text_field :city
    - else
      = f.text_field :city, :value => @location.data['city']
      
  .hidden
    = f.hidden_field :longitude
    = f.hidden_field :latitude

  .error

  %p
    = f.submit "Speichern"

